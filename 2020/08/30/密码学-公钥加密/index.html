<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/images/site.webmanifest">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <meta name="msvalidate.01" content="<meta name="msvalidate.01" content="5D3796A5DDB32CC875380613FB613833" />">
  <meta name="baidu-site-verification" content="<meta name="baidu-site-verification" content="kewHZtFYQk" />">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Helvetica:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-flat-top.min.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lyf35.github.io","root":"/","scheme":"Pisces","version":"8.0.0-rc.5","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}},"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="Math related with public-key encryption Diffie-Hellman problems Fix a cyclic group \(\mathbb{G}\) and a generator \(g\in \mathbb{G}\). Given elements \(h_{1},h_{2}\in \mathbb{G}\), define \(DH_{g}(h_{">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学-公钥加密">
<meta property="og:url" content="http://lyf35.github.io/2020/08/30/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/index.html">
<meta property="og:site_name" content="Yufei Luo&#39;s Blog">
<meta property="og:description" content="Math related with public-key encryption Diffie-Hellman problems Fix a cyclic group \(\mathbb{G}\) and a generator \(g\in \mathbb{G}\). Given elements \(h_{1},h_{2}\in \mathbb{G}\), define \(DH_{g}(h_{">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002514.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002520.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002527.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002716.png">
<meta property="article:published_time" content="2020-08-30T11:58:52.000Z">
<meta property="article:modified_time" content="2020-09-16T14:12:54.000Z">
<meta property="article:author" content="Yufei Luo">
<meta property="article:tag" content="信息安全">
<meta property="article:tag" content="密码学">
<meta property="article:tag" content="计算机基础">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002514.png">

<link rel="canonical" href="http://lyf35.github.io/2020/08/30/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>密码学-公钥加密 | Yufei Luo's Blog</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
 <!--   <div class="headband"></div>-->

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Yufei Luo's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">But I was so much older then, I am younger than that now.</p>
      <img class="custom-logo-image" src="/images/logo.png" alt="Yufei Luo's Blog">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-计算机基础">

    <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80" rel="section"><i class="fa fa-tags fa-fw"></i>计算机基础</a>

  </li>
        <li class="menu-item menu-item-机器学习">

    <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" rel="section"><i class="fa fa-tags fa-fw"></i>机器学习</a>

  </li>
        <li class="menu-item menu-item-深度学习">

    <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0" rel="section"><i class="fa fa-tags fa-fw"></i>深度学习</a>

  </li>
        <li class="menu-item menu-item-工程实践">

    <a href="/categories/%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5" rel="section"><i class="fa fa-tags fa-fw"></i>工程实践</a>

  </li>
        <li class="menu-item menu-item-论文笔记">

    <a href="/categories/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0" rel="section"><i class="fa fa-tags fa-fw"></i>论文笔记</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#math-related-with-public-key-encryption"><span class="nav-number">1.</span> <span class="nav-text">Math related with public-key encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#diffie-hellman-problems"><span class="nav-number">1.1.</span> <span class="nav-text">Diffie-Hellman problems</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa-generation"><span class="nav-number">1.2.</span> <span class="nav-text">RSA generation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#key-management-evolution"><span class="nav-number">2.</span> <span class="nav-text">Key management evolution</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#key-distribution-in-private-key-encryption"><span class="nav-number">2.1.</span> <span class="nav-text">key distribution in private-key encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#problems"><span class="nav-number">2.1.1.</span> <span class="nav-text">Problems</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key-distribution-centers"><span class="nav-number">2.1.2.</span> <span class="nav-text">Key-distribution centers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#needham-schroder-protocol"><span class="nav-number">2.1.3.</span> <span class="nav-text">Needham-Schroder protocol</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#diffie-hellman-protocol"><span class="nav-number">2.2.</span> <span class="nav-text">Diffie-Hellman protocol</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#secure-key-exchange"><span class="nav-number">2.2.1.</span> <span class="nav-text">Secure key exchange</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-diffie-hellman-key-exchange-protocol"><span class="nav-number">2.2.2.</span> <span class="nav-text">The Diffie-Hellman key-exchange protocol</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#public-key-encryption"><span class="nav-number">3.</span> <span class="nav-text">Public-key encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#overview"><span class="nav-number">3.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#public-key-encryption-scheme"><span class="nav-number">3.2.</span> <span class="nav-text">Public-key encryption scheme</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#kemdem-paradigm"><span class="nav-number">3.3.</span> <span class="nav-text">KEM&#x2F;DEM paradigm</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hybrid-encryption"><span class="nav-number">3.3.1.</span> <span class="nav-text">Hybrid encryption</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#construction"><span class="nav-number">3.3.2.</span> <span class="nav-text">Construction</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cdhddh-based-encryption"><span class="nav-number">3.4.</span> <span class="nav-text">CDH&#x2F;DDH-based encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#el-gamal-encryption"><span class="nav-number">3.4.1.</span> <span class="nav-text">El Gamal encryption</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ddh-based-key-encapsulation"><span class="nav-number">3.4.2.</span> <span class="nav-text">DDH-based key encapsulation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dhiesecies"><span class="nav-number">3.4.3.</span> <span class="nav-text">DHIES&#x2F;ECIES</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa-encryption"><span class="nav-number">3.5.</span> <span class="nav-text">RSA encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plain-rsa"><span class="nav-number">3.5.1.</span> <span class="nav-text">Plain RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#padded-rsa-pkcs-1-v1.5"><span class="nav-number">3.5.2.</span> <span class="nav-text">Padded RSA &amp; PKCS #1 v1.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#oaep-rsa-pkcs-1-v2.0"><span class="nav-number">3.5.3.</span> <span class="nav-text">OAEP &amp; RSA PKCS #1 v2.0</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#recommended-key-lengths"><span class="nav-number">4.</span> <span class="nav-text">Recommended key lengths</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#references"><span class="nav-number">5.</span> <span class="nav-text">References</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yufei Luo"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Yufei Luo</p>
  <div class="site-description" itemprop="description">哪怕什么真理无穷，进一寸有进一寸的欢喜</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">90</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2x5ZjM1" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lyf35"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmx5ZjEyMzQwMDAwMDBAMTYzLmNvbQ==" title="E-Mail → mailto:lyf1234000000@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
        <div class="back-to-top animated">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="reading-progress-bar"></div>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2x5ZjM1" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lyf35.github.io/2020/08/30/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Yufei Luo">
      <meta itemprop="description" content="哪怕什么真理无穷，进一寸有进一寸的欢喜">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yufei Luo's Blog">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          密码学-公钥加密
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-30 19:58:52" itemprop="dateCreated datePublished" datetime="2020-08-30T19:58:52+08:00">2020-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-16 22:12:54" itemprop="dateModified" datetime="2020-09-16T22:12:54+08:00">2020-09-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">理论知识</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">信息安全</span></a>
                </span>
            </span>

          
            <span id="/2020/08/30/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/" class="post-meta-item leancloud_visitors" data-flag-title="密码学-公钥加密" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>17k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>15 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="math-related-with-public-key-encryption">Math related with public-key encryption</h1>
<h2 id="diffie-hellman-problems">Diffie-Hellman problems</h2>
<p>Fix a cyclic group <span class="math inline">\(\mathbb{G}\)</span> and a generator <span class="math inline">\(g\in \mathbb{G}\)</span>. Given elements <span class="math inline">\(h_{1},h_{2}\in \mathbb{G}\)</span>, define <span class="math inline">\(DH_{g}(h_{1},h_{2})=g^{log_{g}h_{1}\cdot log_{g}h_{2}}\)</span>. That is, if <span class="math inline">\(h_{1}=g^{x_{1}}\)</span> and <span class="math inline">\(h_{2}=g^{x_{2}}\)</span> then <span class="math display">\[
DH_{g}(h_{1},h_{2})=g^{x_{1}\cdot x_{2}}=h_{1}^{x_{2}}=h_{2}^{x_{1}}
\]</span></p>
<p>The computational Diffie-Hellman(CDH) problem is to compute <span class="math inline">\(DH_{g}(h_{1},h_{2})\)</span> for uniform <span class="math inline">\(h_1\)</span> and <span class="math inline">\(h_2\)</span>. It is not clear whether hardness of the discrete-logarithm problem implies that the CDH problem is hard as well. <span id="more"></span></p>
<p>The decisional Diffie-Hellman(DDH) problem is, when given uniform <span class="math inline">\(h_{1},h_{2}\)</span> and a third group element <span class="math inline">\(h&#39;\)</span>, distinguish whether <span class="math inline">\(h&#39;=DH_{g}(h_{1},h_{2})\)</span> or <span class="math inline">\(h&#39;\)</span> is chosen from a uniform group element.</p>
<h2 id="rsa-generation">RSA generation</h2>
<figure>
<img data-src="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002514.png" alt="image-20201019230737926" /><figcaption aria-hidden="true">image-20201019230737926</figcaption>
</figure>
<h1 id="key-management-evolution">Key management evolution</h1>
<h2 id="key-distribution-in-private-key-encryption">key distribution in private-key encryption</h2>
<h3 id="problems">Problems</h3>
<ul>
<li>Key distribution: The key must be shared through a secure channel.</li>
<li>Storing and managing large number of secret keys: N people communicating with each other need to store N-1 secret keys for each one.</li>
<li>Inapplicability of private-key cryptography to open systems: can not interact with new users.</li>
</ul>
<h3 id="key-distribution-centers">Key-distribution centers</h3>
<p>A key-distribution center(KDC) can become a partial solution for the problem above. An entity trusted by all the users serves as a key-distribution center and it helps all the users share pairwise keys.</p>
<p><strong>Offline fashion</strong>: When a new people <span class="math inline">\(i\)</span> join, the KDC shares a key with this people, and also distributes <span class="math inline">\(n-1\)</span> shared keys between <span class="math inline">\(i\)</span> and other <span class="math inline">\(1\sim i-1\)</span> people.</p>
<p><strong>Online fashion</strong>: Generate key on demand whenever Alice and Bob need to communicate securely. Choose a new, random key <span class="math inline">\(k\)</span>, then send to Alice encrypted using <span class="math inline">\(k_{A}\)</span> and to Bob encrypted using <span class="math inline">\(k_{B}\)</span>. (<span class="math inline">\(k_{A}\)</span> is a private key between KDC and Alice)</p>
<p>The KDC can alleviate two of the problem: the key distribution is simplified, and the key storage is eased.</p>
<p>There are also some drawbacks: the KDC is a single point of failure, and a successful attack on the KDC will result in a complete break of the system.</p>
<h3 id="needham-schroder-protocol">Needham-Schroder protocol</h3>
<p>A protocol for secure key distribution using KDC. One of its features is that KDC sends to Alice the session key encrypted under Alice's key in addition to the session key encrypted under Bob's key. Alice then sends the second ciphertext to Bob as a credential that allows Alice talk to Bob.</p>
<p>The process is shown as the following figure:</p>
<p><img data-src="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002520.png" alt="image-20201019231425359" style="zoom: 50%;" /></p>
<h2 id="diffie-hellman-protocol">Diffie-Hellman protocol</h2>
<p>The KDC approaches still require a private and authenticated channel that can be used to share keys, so it is still not applicable in open systems.</p>
<p>Diffie and Hellman's paper stated that there are certain actions that can be easily performed but not easily reversed. This phenomena could be used to derive interactive protocols for sercure key exchange that allow two parties to share a secret key via communication over a public but authenticated channel, by having the parties perform operations that they can reverse but that an eavesdropper cannot.</p>
<h3 id="secure-key-exchange">Secure key exchange</h3>
<p>The key-exchange experiment <span class="math inline">\(KE_{\mathcal{A},\pi}^{eav}(n)\)</span>:</p>
<ol type="1">
<li><p>Two parties holding <span class="math inline">\(1^n\)</span> execute protocol <span class="math inline">\(\Pi\)</span>. This results in a transcript <span class="math inline">\(trans\)</span> containing all the messages sent by the parties, and a key <span class="math inline">\(k\)</span> output by each of the parties.</p></li>
<li><p>A uniform bit <span class="math inline">\(b\in \{0,1\}\)</span> is chosen. If <span class="math inline">\(b=0\)</span> set <span class="math inline">\(\hat{k}:=k\)</span>, and if b=1 then choose <span class="math inline">\(\hat{k}\in \{0,1\}^{n}\)</span> uniformly at random</p></li>
<li><p><span class="math inline">\(\mathcal{A}\)</span> is given <span class="math inline">\(trans\)</span> and <span class="math inline">\(\hat{k}\)</span>, and output a bit <span class="math inline">\(b&#39;\)</span></p></li>
<li><p>The output of the experiment is defined to be 1 if <span class="math inline">\(b&#39;=b\)</span> and 0 otherwise. In the case that <span class="math inline">\(KE_{\mathcal{A},\pi}^{eav}(n)=1\)</span> we say that <span class="math inline">\(\mathcal{A}\)</span> succeeds.</p></li>
</ol>
<p>A key-exchange protocol <span class="math inline">\(\Pi\)</span> is secure in the presence of <em>an eavesdropper</em> if for all probabilistic polynomial-time adversaries <span class="math inline">\(\mathcal{A}\)</span> there is a negligible function <span class="math inline">\(negl\)</span> such that <span class="math display">\[
Pr[KE_{\mathcal{A},\pi}^{eav}(n)=1]\le \frac{1}{2}+negl(n)
\]</span></p>
<h3 id="the-diffie-hellman-key-exchange-protocol">The Diffie-Hellman key-exchange protocol</h3>
<p>Let <span class="math inline">\(\mathcal{G}\)</span> be a probabilistic polynomial-time algorithm that, on input <span class="math inline">\(1^n\)</span>, outputs a description of a cyclic group <span class="math inline">\(\mathbb{G}\)</span>, its order <span class="math inline">\(q\)</span> with <span class="math inline">\(||q||=n\)</span>, and a generator <span class="math inline">\(g\in \mathbb{G}\)</span>. The Diffie-Hellman key-exchange protocol can be described as follows:</p>
<ul>
<li><strong>Common input</strong>: The security parameter <span class="math inline">\(1^n\)</span>.</li>
<li><strong>The protocol</strong>:
<ol type="1">
<li>Alice runs <span class="math inline">\(\mathcal{G}(1^{n})\)</span> to obtain <span class="math inline">\((\mathbb{G},q,g)\)</span>.</li>
<li>Alice chooses a uniform <span class="math inline">\(x\in \mathbb{Z}_{q}\)</span>, and computes <span class="math inline">\(h_{A}:=g^x\)</span>.</li>
<li>Alice sends <span class="math inline">\((\mathbb{G},q,g,h_{A})\)</span> to Bob.</li>
<li>Bob receives <span class="math inline">\((\mathbb{G},q,g,h_{A})\)</span>. He chooses a uniform <span class="math inline">\(y\in \mathbb{Z}_{q}\)</span>, and computes <span class="math inline">\(h_{B}:=g^y\)</span>. Bob sends <span class="math inline">\(h_{B}\)</span> to Alice and outputs the key <span class="math inline">\(k_{B}:=h_{A}^{y}\)</span>.</li>
<li>Alice receives <span class="math inline">\(h_{B}\)</span> and outputs the key <span class="math inline">\(k_{A}:=h_{B}^{x}\)</span>.</li>
</ol></li>
</ul>
<p>The following figure illustrate the construction of Diffie-Hellman key-exchange protocol:</p>
<p><img data-src="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002527.png" alt="image-20201019231826956" style="zoom: 50%;" /></p>
<p>If the decisional Diffie-Hellman problem is hard relative to <span class="math inline">\(\mathcal{G}\)</span>, then the Diffie-Hellman key-exchange protocol <span class="math inline">\(\Pi\)</span> is secure in the presence of an eavesdropper.</p>
<p>Please note that the shared key is indistinguishable from a <em>uniform element of <span class="math inline">\(\mathbb{G}\)</span></em> rather than from a uniform n-bit string.</p>
<p>In order to use the key for subsequent cryptographic applications, the key output by the parties should be indistinguishable from a uniform bit-string of the appropriate length. The Diffie-Hellman protocol can be modified to achieve this by using an appropriate <em>key-derivation function</em>.</p>
<p>Diffie-Hellman protocol is completely insecure against man-in-the-middle attacks (both honest parties are executing the protocol and the adversary is intercepting and modifying messages being sent from one party to the other). But it is the core of standardized key-exchange protocols today.</p>
<h1 id="public-key-encryption">Public-key encryption</h1>
<h2 id="overview">Overview</h2>
<p>In public-key encryption, the receiver generates a pair of keys <span class="math inline">\((pk,sk)\)</span>, called the <em>public key</em> and <em>private key</em> respectively. The public key is used by the sender to encrypt a message; the receiver uses the private key to decrypt the resulting ciphertext.</p>
<p>Two ways to learn <span class="math inline">\(pk\)</span> (Alice is the receiver and Bob is the sender):</p>
<ol type="1">
<li><p>When Alice learns that Bob wants to communicate with her, generate <span class="math inline">\((pk,sk)\)</span> and then send <span class="math inline">\(pk\)</span> to Bob in the clear.</p></li>
<li><p>Alice generate her keys <span class="math inline">\((pk,sk)\)</span> in advance, independently of any particular sender. Then she can widely disseminate <span class="math inline">\(pk\)</span> so that anyone who wishes to communicate with her can use <span class="math inline">\(pk\)</span> directly.</p></li>
</ol>
<p>Some important notes for public-key encryption:</p>
<ul>
<li>The security of public-key encryption relies on the secrecy of <span class="math inline">\(sk\)</span>.</li>
<li>The security of public-key encryption is under the assumption that the sender are able to obtain a legitimate copy of the receiver's public key.</li>
</ul>
<p>Comparison with private-key encryption:</p>
<ul>
<li>Advantages:
<ol type="1">
<li>The key-distribution could be done over public but authenticated channels, since <span class="math inline">\(pk\)</span> do not need to be secret.</li>
<li>Reduce the need for users to store many secret keys.</li>
<li>More suitable for open environments.</li>
</ol></li>
<li>Drawbacks:
<ol type="1">
<li>The receiver could receive messages from anyone. (When receiver only wants to receive the message from specific invididuals it is a drawback).</li>
<li>Roughly <strong>2 to 3 orders of magnitude slower</strong> than private-key encryption.</li>
</ol></li>
</ul>
<h2 id="public-key-encryption-scheme">Public-key encryption scheme</h2>
<p>A public-key encryption scheme is a triple of probabilistic polynomial-time algorithms <span class="math inline">\((Gen,Enc,Dec)\)</span> such that:</p>
<ol type="1">
<li>The key-generation algorithm <span class="math inline">\(Gen\)</span> takes the security parameter <span class="math inline">\(1^n\)</span> as input and outputs a pair of keys <span class="math inline">\((pk,sk)\)</span>. We refer to the first of these as the <em>public key</em> and the second as <em>private key</em>. Assuming for convenience that <span class="math inline">\(pk\)</span> and <span class="math inline">\(sk\)</span> each has length at least <span class="math inline">\(n\)</span>, and <span class="math inline">\(n\)</span> can be determined from <span class="math inline">\(pk,sk\)</span>.</li>
<li>The encryption algorithm <span class="math inline">\(Enc\)</span> takes a public key <span class="math inline">\(pk\)</span> and a message <span class="math inline">\(m\)</span> from some message space (depend on <span class="math inline">\(pk\)</span>) as input. It outputs a ciphertext <span class="math inline">\(c\)</span>, and we write it as <span class="math inline">\(c\leftarrow Enc_{pk}(m)\)</span>. (Write this way means that <span class="math inline">\(Enc\)</span> is probabilistic, which is needed to achieve meaningful security)</li>
<li>The deterministic decryption algorithm <span class="math inline">\(Dec\)</span> takes a private key <span class="math inline">\(sk\)</span> and a ciphertext <span class="math inline">\(c\)</span> as input, and outputs a message <span class="math inline">\(m\)</span> or a special symbol denoting failure. We write this as <span class="math inline">\(m:=Dec_{sk}(c)\)</span>.</li>
</ol>
<h2 id="kemdem-paradigm">KEM/DEM paradigm</h2>
<h3 id="hybrid-encryption">Hybrid encryption</h3>
<p>In hybrid encryption, both private-key encryption and public-key encryption are used. The aims of using hybrid encryption:</p>
<ul>
<li>Private-key encryption can increase efficiency.</li>
<li>Using public-key encryption to increase bandwidth.</li>
</ul>
<p>Note that although the private-key encryption is used as a component, this method still belongs to public encryption schemes, since <em>the sender and receiver do not share any secret key in advance</em>.</p>
<h3 id="construction">Construction</h3>
<p>A key-encapsulation mechanism(KEM) is a tuple of probabilistic polynomial-time algorithms <span class="math inline">\((Gen,Encaps,Decaps)\)</span> such that:</p>
<ol type="1">
<li><p>The key-generation algorithm <span class="math inline">\(Gen\)</span> takes as input the security parameter <span class="math inline">\(1^n\)</span> and outputs a public-/private-key pair <span class="math inline">\((pk,sk)\)</span>. Assuming that <span class="math inline">\(pk\)</span> and <span class="math inline">\(sk\)</span> each has length at least <span class="math inline">\(n\)</span>, and <span class="math inline">\(n\)</span> can be determined from <span class="math inline">\(pk,sk\)</span>.</p></li>
<li><p>The encapsulation algorithm <span class="math inline">\(Encaps\)</span> takes as input a public key <span class="math inline">\(pk\)</span> and the security parameter <span class="math inline">\(1^n\)</span>. It outputs a ciphertext <span class="math inline">\(c\)</span> and a key <span class="math inline">\(k\in \{0,1\}^{\ell (n)}\)</span> where <span class="math inline">\(\ell\)</span> is the key length. It can be written as <span class="math inline">\((c,k)\leftarrow Encaps_{pk}(1^{n})\)</span>.</p></li>
<li><p>The deterministic decapsulation algorithm <span class="math inline">\(Decaps\)</span> takes as input a private key <span class="math inline">\(sk\)</span> and a ciphertext <span class="math inline">\(c\)</span>, and outputs a key <span class="math inline">\(k\)</span> or a special symbol denoting failure. We write this as <span class="math inline">\(k:=Decaps_{sk}(c)\)</span>.</p></li>
</ol>
<p>By using a KEM, a key <span class="math inline">\(k\)</span> is generated and then is used for private-key encryption. The private-key encrypton scheme is called the data-encapsulation mechanism(DEM).</p>
<p>Using the construction above, we can construct hybrid encryption using the KEM/DEM paradigm:</p>
<p>Let <span class="math inline">\(\Pi=(Gen,Encaps,Decaps)\)</span> be a KEM with key length <span class="math inline">\(n\)</span>, and let <span class="math inline">\(\Pi&#39;=(Gen&#39;,Enc&#39;,Dec&#39;)\)</span> be a private-key encryption scheme. Construct a public-key encryption scheme <span class="math inline">\(\Pi^{hy}=(Gen^{hy},Enc^{hy},Dec^{hy})\)</span> as follows:</p>
<ul>
<li><span class="math inline">\(Gen^{hy}\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(Gen(1^{n})\)</span> and use the public and private keys <span class="math inline">\((pk,sk)\)</span> that are output.</li>
<li><span class="math inline">\(Enc^{hy}\)</span>: on input a public key <span class="math inline">\(pk\)</span> and a message <span class="math inline">\(m\in \{0,1\}^*\)</span> do:
<ol type="1">
<li>Compute <span class="math inline">\((c,k)\leftarrow Encaps_{pk}(1^n)\)</span>.</li>
<li>Compute <span class="math inline">\(c&#39;\leftarrow Enc_{k}^{&#39;}(m)\)</span>.</li>
<li>Output the ciphertext <span class="math inline">\(&lt;c,c&#39;&gt;\)</span>.</li>
</ol></li>
<li><span class="math inline">\(Dec^{hy}\)</span>: on input a private key <span class="math inline">\(sk\)</span> and a ciphertext <span class="math inline">\(&lt;c,c&#39;&gt;\)</span> do:
<ol type="1">
<li>Compute <span class="math inline">\(k:=Decaps_{sk}(c)\)</span>.</li>
<li>Output the message <span class="math inline">\(m:=Dec_{k}^{&#39;}(c&#39;)\)</span>.</li>
</ol></li>
</ul>
<h2 id="cdhddh-based-encryption">CDH/DDH-based encryption</h2>
<h3 id="el-gamal-encryption">El Gamal encryption</h3>
<p>Let <span class="math inline">\(\mathcal{G}\)</span> be a probabilistic polynomial-time algorithm that, on input <span class="math inline">\(1^n\)</span>, outputs a description of a cyclic group <span class="math inline">\(\mathbb{G}\)</span>, its order <span class="math inline">\(q\)</span> with <span class="math inline">\(||q||=n\)</span>, and a generator <span class="math inline">\(g\in \mathbb{G}\)</span>. Define the El Gamal encryption scheme as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(\mathcal{G}(1^{n})\)</span> to obtain <span class="math inline">\((\mathbb{G},q,g)\)</span>. Then choose a uniform <span class="math inline">\(x\in \mathbb{Z}_q\)</span> and compute <span class="math inline">\(h:=g^x\)</span>. The public key is <span class="math inline">\(&lt;\mathbb{G},q,g,h&gt;\)</span> and the private key is <span class="math inline">\(&lt;\mathbb{G},q,g,x&gt;\)</span>. The message space is <span class="math inline">\(\mathbb{G}\)</span>.</li>
<li><span class="math inline">\(Enc\)</span>: on input a public key <span class="math inline">\(pk=&lt;\mathbb{G},q,g,h&gt;\)</span> and a message <span class="math inline">\(m\in \mathbb{G}\)</span>, choose a uniform <span class="math inline">\(y\in \mathbb{Z}_q\)</span> and output the ciphertext <span class="math inline">\(&lt;g^{y},h^{y}\cdot m&gt;\)</span>.</li>
<li><span class="math inline">\(Dec\)</span>: on input a private key <span class="math inline">\(sk=&lt;\mathbb{G},q,g,x&gt;\)</span> and a ciphertext <span class="math inline">\(&lt;c_{1},c_{2}&gt;\)</span>, output <span class="math inline">\(\hat{m}:=c_{2}/c_{1}^{x}\)</span>.</li>
</ul>
<p>If the DDH problem is hard relative to <span class="math inline">\(\mathcal{G}\)</span>, then the El Gamal encryption scheme is CPA-secure, but it is not CCA-secure!</p>
<p>Some implementation issues:</p>
<ul>
<li>It is common for these parameters generated by <span class="math inline">\(Gen\)</span> to be fixed once for all, and then shared by multiple receivers. Sharing parameters in this way <em>does not impact security</em>.</li>
<li>The group order <span class="math inline">\(q\)</span> is generally chosen to be prime. And elliptic curves are one popular choice.</li>
<li>The message space is a group <span class="math inline">\(\mathbb{G}\)</span> rather than bit-strings. So the messages need to be encoded as group elements before encryption, and decoded after decryption.</li>
</ul>
<h3 id="ddh-based-key-encapsulation">DDH-based key encapsulation</h3>
<p>Let <span class="math inline">\(\mathcal{G}\)</span> be a probabilistic polynomial-time algorithm that, on input <span class="math inline">\(1^n\)</span>, outputs a description of a cyclic group <span class="math inline">\(\mathbb{G}\)</span>, its order <span class="math inline">\(q\)</span> with <span class="math inline">\(||q||=n\)</span>, and a generator <span class="math inline">\(g\in \mathbb{G}\)</span>. Define a KEM as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(\mathcal{G}(1^{n})\)</span> to obtain <span class="math inline">\((\mathbb{G},q,g)\)</span>. Then choose a uniform <span class="math inline">\(x\in \mathbb{Z}_q\)</span> and compute <span class="math inline">\(h:=g^x\)</span>. Also specify a function <span class="math inline">\(H:\mathbb{G}\rightarrow \{0,1\}^{\ell (n)}\)</span> for some function <span class="math inline">\(\ell\)</span>. The public key is <span class="math inline">\(&lt;\mathbb{G},q,g,h,H&gt;\)</span> and the private key is <span class="math inline">\(&lt;\mathbb{G},q,g,x&gt;\)</span>.</li>
<li><span class="math inline">\(Encaps\)</span>: on input a public key <span class="math inline">\(pk=&lt;\mathbb{G},q,g,h,H&gt;\)</span>, choose a uniform <span class="math inline">\(y\in \mathbb{Z}_q\)</span> and output the ciphertext <span class="math inline">\(g^{y}\)</span> and the key <span class="math inline">\(H(h^{y})\)</span>.</li>
<li><span class="math inline">\(Decaps\)</span>: on input a private key <span class="math inline">\(sk=&lt;\mathbb{G},q,g,x&gt;\)</span> and a ciphertext <span class="math inline">\(c\in \mathbb{G}\)</span>, output the key <span class="math inline">\(H(c^{x})\)</span>.</li>
</ul>
<p>If the gap-CDH problem (based on CDH problem, additionally give access to an oracle <span class="math inline">\(\mathcal{O}\)</span> that <span class="math inline">\(\mathcal{O}(U,V)\)</span> returns 1 when <span class="math inline">\(V=U^y\)</span>) is hard relative to <span class="math inline">\(\mathcal{G}\)</span>, and <span class="math inline">\(H\)</span> is modeled as a random oracle (an ideal model that treats a cryptographic hash function <span class="math inline">\(H\)</span> as a truly random function), then the above construction is a CCA-secure KEM.</p>
<h3 id="dhiesecies">DHIES/ECIES</h3>
<p>Let <span class="math inline">\(\mathcal{G}\)</span> be a probabilistic polynomial-time algorithm that, on input <span class="math inline">\(1^n\)</span>, outputs a description of a cyclic group <span class="math inline">\(\mathbb{G}\)</span>, its order <span class="math inline">\(q\)</span> with <span class="math inline">\(||q||=n\)</span>, and a generator <span class="math inline">\(g\in \mathbb{G}\)</span>. Let <span class="math inline">\(\Pi_{E}=(Enc&#39;,Dec&#39;)\)</span> be a private-key encryption scheme, and let <span class="math inline">\(\Pi_{M}=(Mac,Vrfy)\)</span> be a message authentication code. Define a public-key encryption scheme as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: On input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(\mathcal{G}(1^{n})\)</span> to obtain <span class="math inline">\((\mathbb{G},q,g)\)</span>. Choose a uniform <span class="math inline">\(x\in \mathbb{Z}_q\)</span>, set <span class="math inline">\(h:=g^x\)</span>, and specify a function <span class="math inline">\(H:\mathbb{G}\rightarrow \{0,1\}^{2n}\)</span>. The public key is <span class="math inline">\(&lt;\mathbb{G},q,g,h,H&gt;\)</span> and the private key is <span class="math inline">\(&lt;\mathbb{G},q,g,x,H&gt;\)</span>.</li>
<li><span class="math inline">\(Enc\)</span>: On input a public key <span class="math inline">\(pk=&lt;\mathbb{G},q,g,h,H&gt;\)</span>, choose a uniform <span class="math inline">\(y\in \mathbb{Z}_q\)</span> and set <span class="math inline">\(k_{E}||k_{M}:=H(h^{y})\)</span>. Compute <span class="math inline">\(c&#39;=Enc_{k_{E}}^{&#39;}(m)\)</span> and output the ciphertext <span class="math inline">\(&lt;g^{y},c&#39;,Mac_{k_{M}}(c&#39;)&gt;\)</span>.</li>
<li><span class="math inline">\(Dec\)</span>: On input a private key <span class="math inline">\(sk=&lt;\mathbb{G},q,g,x,H&gt;\)</span> and a ciphertext <span class="math inline">\(&lt;c,c&#39;,t&gt;\)</span>, output failure if <span class="math inline">\(c\notin \mathbb{G}\)</span>. Else, compute <span class="math inline">\(k_{E}||k_{M}:=H(c^{x})\)</span>. If <span class="math inline">\(Vrfy_{k_{M}}(c&#39;,t)\ne 1\)</span> then output failure, otherwise output <span class="math inline">\(Dec_{k_{E}}^{&#39;}(c&#39;)\)</span>.</li>
</ul>
<p>When the group <span class="math inline">\(\mathbb{G}\)</span> is a cyclic subgroup of a finite field, this encryption scheme is called the Diffie-Hellman Integrated Encryption Scheme (DHIES). And When <span class="math inline">\(\mathbb{G}\)</span> is an elliptic-curve group, it is called the Elliptic Curve Integrated Encryption Scheme (ECIES).</p>
<p>Let <span class="math inline">\(\Pi_{E}\)</span> be a CPA-secure private-key encryption scheme, and let <span class="math inline">\(\Pi_{M}\)</span> be a strongly secure message authentication code. If the gap-CDH problem is hard relative to <span class="math inline">\(\mathcal{G}\)</span>, and <span class="math inline">\(H\)</span> is modeled as a random oracle, then the above construction is a CCA-secure public-key encryption scheme.</p>
<h2 id="rsa-encryption">RSA encryption</h2>
<h3 id="plain-rsa">Plain RSA</h3>
<p>Using RSA generation algorithm , define the plain RSA encryption scheme as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(GenRSA(1^{n})\)</span> to obtain <span class="math inline">\(N\)</span>, <span class="math inline">\(e\)</span> and <span class="math inline">\(d\)</span>. The public key is <span class="math inline">\(&lt;N,e&gt;\)</span> and the private key is <span class="math inline">\(&lt;N,d&gt;\)</span>.</li>
<li><span class="math inline">\(Enc\)</span>: on input a public key <span class="math inline">\(pk=&lt;N,e&gt;\)</span> and a message <span class="math inline">\(m\in \mathbb{Z}_{N}^{*}\)</span>, compute the ciphertext <span class="math inline">\(c:=[m^{e}~mod~N]\)</span></li>
<li><span class="math inline">\(Dec\)</span>: on input a private key <span class="math inline">\(sk=&lt;N,d&gt;\)</span> and a ciphertext <span class="math inline">\(c\in \mathbb{Z}_{N}^{*}\)</span>, compute the message <span class="math inline">\(m:=[c^{d}~mod~N]\)</span>.</li>
</ul>
<p>Plain RSA encryption is deterministic and so it is not CPA-secure!</p>
<h3 id="padded-rsa-pkcs-1-v1.5">Padded RSA &amp; PKCS #1 v1.5</h3>
<p>Using RSA generation algorithm, and let <span class="math inline">\(\ell\)</span> be a function with <span class="math inline">\(\ell (n)\le 2n-4\)</span> for all <span class="math inline">\(n\)</span>. Define a public-key encryption scheme as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(GenRSA(1^{n})\)</span> to obtain <span class="math inline">\(N\)</span>, <span class="math inline">\(e\)</span> and <span class="math inline">\(d\)</span>. The public key is <span class="math inline">\(&lt;N,e&gt;\)</span> and the private key is <span class="math inline">\(&lt;N,d&gt;\)</span>.</li>
<li><span class="math inline">\(Enc\)</span>: on input a public key <span class="math inline">\(pk=&lt;N,e&gt;\)</span> and a message <span class="math inline">\(m\in \{0,1\}^{||N||-\ell (n)-2}\)</span>, choose a uniform string <span class="math inline">\(r\in \{0,1\}^{\ell (n)}\)</span> and interpret <span class="math inline">\(\hat{m}:=r||m\)</span> as an element of <span class="math inline">\(\mathbb{Z}_{N}^{*}\)</span>. Output the ciphertext <span class="math inline">\(c:=[\hat{m}^{e}~mod~N]\)</span>.</li>
<li><span class="math inline">\(Dec\)</span>: on input a private key <span class="math inline">\(sk=&lt;N,d&gt;\)</span> and a ciphertext <span class="math inline">\(c\in \mathbb{Z}_{N}^{*}\)</span>, compute <span class="math inline">\(\hat{m}:=[c^{d}~mod~N]\)</span> and output the <span class="math inline">\(||N||-\ell (n)-2\)</span> least-significant bits of <span class="math inline">\(\hat{m}\)</span>.</li>
</ul>
<p>The RSA laboratories Public-Key Cryptography Standard (PKCS) #1 version 1.5, utilizes a varient of padded RSA encryption. Let <span class="math inline">\(k\)</span> denote an integer satisfying <span class="math inline">\(2^{8(k-1)}\le N \le 2^{8k}\)</span> (the length of <span class="math inline">\(N\)</span> in bytes). Messages <span class="math inline">\(m\)</span> to be encrypted are assumed to be a multiple of 8 bits long and can have length anywhere from one to <span class="math inline">\(k-11\)</span> bytes. Encryption of a message <span class="math inline">\(m\)</span> is computed as <span class="math inline">\([(0x00||0x02||r||0x00||m)^{e}~mod~N]\)</span>, where <span class="math inline">\(r\)</span> is randomly generated.</p>
<p>Unfortunately, PKCS #1 v1.5 as specified is not CPA-secure because it allows using random padding that is too short. If we force <span class="math inline">\(r\)</span> to be roughly half the length of <span class="math inline">\(N\)</span>, then it is reasonable to <em>conjecture</em> that the encryption scheme in PKCS #1 v1.5 is CPA-secure. Also, PKCS #1 v1.5 is not CCA-secure.</p>
<h3 id="oaep-rsa-pkcs-1-v2.0">OAEP &amp; RSA PKCS #1 v2.0</h3>
<p>Let <span class="math inline">\(GenRSA\)</span> be as in the previous sections, and <span class="math inline">\(\ell(n),k_{0}(n),k_{1}(n)\)</span> be integer-valued functions with <span class="math inline">\(k_{0}(n),k_{1}(n)=\Theta(n)\)</span> and that <span class="math inline">\(\ell(n)+k_{0}(n)+k_{1}(n)\)</span> is less than the minimum bit-length of moduli output by <span class="math inline">\(GenRSA(1^{n})\)</span>. Let <span class="math inline">\(G:\{0,1\}^{k_{0}}\rightarrow \{0,1\}^{\ell+k_{1}}\)</span> and <span class="math inline">\(H:\{0,1\}^{\ell+k_{1}}\rightarrow \{0,1\}^{k_{0}}\)</span> be functions. Construct the RSA-OAEP encryption scheme as follows:</p>
<ul>
<li><span class="math inline">\(Gen\)</span>: on input <span class="math inline">\(1^n\)</span> run <span class="math inline">\(GenRSA(1^{n})\)</span> to obtain <span class="math inline">\(N\)</span>, <span class="math inline">\(e\)</span> and <span class="math inline">\(d\)</span>. The public key is <span class="math inline">\(&lt;N,e&gt;\)</span> and the private key is <span class="math inline">\(&lt;N,d&gt;\)</span>.</li>
<li><span class="math inline">\(Enc\)</span>: on input a public key <span class="math inline">\(&lt;N,e&gt;\)</span> and a message <span class="math inline">\(m\in \{0,1\}^{\ell}\)</span>, set <span class="math inline">\(m&#39;:=m||0^{k_{1}}\)</span> and choose a uniform <span class="math inline">\(r\in \{0,1\}^{k_{0}}\)</span>. Then compute <span class="math inline">\(s:=m&#39;~XOR~G(r)\)</span>, <span class="math inline">\(t:=r~XOR~H(s)\)</span>, and set <span class="math inline">\(\hat{m}:=s||t\)</span>. Output the ciphertext <span class="math inline">\(c:=[\hat{m}^{e}~mod~N]\)</span>.</li>
<li><span class="math inline">\(Dec\)</span>: on input a private key <span class="math inline">\(&lt;N,d&gt;\)</span> and a ciphertext <span class="math inline">\(c\in \mathbb{Z}_{N}^{*}\)</span>, compute <span class="math inline">\(\hat{m}:=[c^{d}~mod~N]\)</span>. If <span class="math inline">\(||\hat{m}||&gt;\ell +k_{0}+k_{1}\)</span>, output error. Otherwise, parse <span class="math inline">\(\hat{m}\)</span> as <span class="math inline">\(s||t\)</span> with <span class="math inline">\(s\in \{0,1\}^{\ell+k_{1}}\)</span> and <span class="math inline">\(t\in \{0,1\}^{k_{0}}\)</span>. Compute <span class="math inline">\(r:=H(s)~XOR~t\)</span> and <span class="math inline">\(m&#39;:=G(r)~XOR~s\)</span>. If the least-significant <span class="math inline">\(k_1\)</span> bits of <span class="math inline">\(m&#39;\)</span> are not all 0, output error. Otherwise, output the <span class="math inline">\(\ell\)</span> most-significant bits of <span class="math inline">\(\hat{m}\)</span>.</li>
</ul>
<p>The RSA-OAEP encryption scheme is CCA-secure. But the encryption scheme should ensure that the time to return an error is identical regardless of where the error occurs, otherwise this information can be used as side-channel information in CCA.</p>
<h1 id="recommended-key-lengths">Recommended key lengths</h1>
<figure>
<img data-src="https://raw.githubusercontent.com/lyf35/blog_figures/main/img/20201105002716.png" alt="image-20201020001434684" /><figcaption aria-hidden="true">image-20201020001434684</figcaption>
</figure>
<h1 id="references">References</h1>
<ol type="1">
<li>Jonathan Katz, Yehuda Lindell. Introduction to Modern Cryptography, Second Edition.</li>
<li>https://baike.baidu.com/item/SM2/15081831?fr=aladdin</li>
<li>https://blog.csdn.net/BlackNight168/article/details/88169642</li>
<li>https://blog.csdn.net/samsho2/article/details/80772228</li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Yufei Luo
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://lyf35.github.io/2020/08/30/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/" title="密码学-公钥加密">http://lyf35.github.io/2020/08/30/密码学-公钥加密/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" rel="tag"><i class="fa fa-tag"></i> 信息安全</a>
              <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag"><i class="fa fa-tag"></i> 密码学</a>
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" rel="tag"><i class="fa fa-tag"></i> 计算机基础</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/10/%E5%AF%86%E7%A0%81%E5%AD%A6-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" rel="prev" title="密码学-哈希函数">
      <i class="fa fa-chevron-left"></i> 密码学-哈希函数
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/09/10/%E5%AF%86%E7%A0%81%E5%AD%A6-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" rel="next" title="密码学-数字签名">
      密码学-数字签名 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yufei Luo</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">22:56</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9waXNjZXMv">NexT.Pisces</span> 强力驱动
  </div>

        






<script data-pjax>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      const visitors = document.querySelector('.leancloud_visitors');
      const url = decodeURI(visitors.id);
      const title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            const counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      const visitors = document.querySelectorAll('.leancloud_visitors');
      const entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"ypNNXSdcGIIoldC5BBmViS2g-gzGzoHsz","app_key":"0TDwohU7eO4yHTn4tley8PtE","server_url":"https://leancloud.cn/dashboard/data.html?appid=ypNNXSdcGIIoldC5BBmViS2g-gzGzoHsz#/","security":false};
    function fetchData(api_server) {
      const Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    const api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="//cdn.jsdelivr.net/npm/ribbon.js@1/dist/ribbon.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/next-theme/pjax@0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  
  <script data-pjax>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>









<script data-pjax>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>


    <div class="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      const script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments('#gitalk-container', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '4dcdc02d24075b0e9d3a',
      clientSecret: '53cf2cb8b89b9d4bba922bb19bda1290f0d0bf95',
      repo        : 'lyf35.github.io',
      owner       : 'lyf35',
      admin       : ['lyf35'],
      id          : '5a1c4ab9ce284acff222f5459aa03b30',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

    </div>
</body>
</html>
